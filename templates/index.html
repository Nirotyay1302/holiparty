{% extends "base.html" %}

{% block hero %}
<section id="home" class="hero-section">
    <div class="hero-content">
        <div class="color-dots">
            <div class="color-dot"></div>
            <div class="color-dot"></div>
            <div class="color-dot"></div>
            <div class="color-dot"></div>
            <div class="color-dot"></div>
            <div class="color-dot"></div>
        </div>
        <div class="confetti">
            <div class="confetti-piece" style="left: 10%; animation-delay: 0s;"></div>
            <div class="confetti-piece" style="left: 20%; animation-delay: 1s;"></div>
            <div class="confetti-piece" style="left: 30%; animation-delay: 2s;"></div>
            <div class="confetti-piece" style="left: 40%; animation-delay: 0.5s;"></div>
            <div class="confetti-piece" style="left: 50%; animation-delay: 1.5s;"></div>
            <div class="confetti-piece" style="left: 60%; animation-delay: 2.5s;"></div>
            <div class="confetti-piece" style="left: 70%; animation-delay: 0.8s;"></div>
            <div class="confetti-piece" style="left: 80%; animation-delay: 1.8s;"></div>
            <div class="confetti-piece" style="left: 90%; animation-delay: 2.2s;"></div>
        </div>
        <h1 class="display-4 fw-bold">Experience the Colors of Joy</h1>
        <p class="lead mb-4">Join us for the ultimate Holi celebration with music, dance, and vibrant festivities that
            bring everyone together in joy and harmony.</p>
        <div class="alert alert-danger border-3 mb-4 py-3 px-4 text-center"
            style="background: linear-gradient(135deg, #fff5f5 0%, #ffe8e8 100%); border-color: #dc3545 !important;">
            <strong class="fs-5">üìÖ Last Date of Registration: {{ content.get('registration_deadline', 'February 28,
                2026') }}</strong>
            <p class="mb-0 mt-2 small">Register before the countdown ends!</p>
        </div>
        <div class="countdown-timer mb-4"
            data-event-date="{{ content.get('registration_deadline', 'February 28, 2026') }}">
            <div class="countdown-item">
                <div class="number" id="days">00</div>
                <div class="label">Days</div>
            </div>
            <div class="countdown-item">
                <div class="number" id="hours">00</div>
                <div class="label">Hours</div>
            </div>
            <div class="countdown-item">
                <div class="number" id="minutes">00</div>
                <div class="label">Minutes</div>
            </div>
            <div class="countdown-item">
                <div class="number" id="seconds">00</div>
                <div class="label">Seconds</div>
            </div>
        </div>
        <p class="text-white mb-3 small"><strong>Countdown to last registration date ({{
                content.get('registration_deadline', 'February 28, 2026') }})</strong>
        </p>
        <div class="mb-4 d-flex flex-wrap justify-content-center gap-2">
            <span class="badge bg-warning text-dark fs-6 px-3 py-2 rounded-pill">Event: {{ content.event_date }} at {{
                content.event_time }} | Venue: {{ content.venue }}</span>
            <span class="badge bg-warning text-dark fs-6 px-3 py-2 rounded-pill">Our 2nd Year of HoliParty! | Entry from
                ‚Çπ{{ content.pricing.entry_pass }}</span>
        </div>
        <div class="d-flex justify-content-center gap-3 flex-wrap">
            <a href="#booking" class="btn btn-primary btn-lg">Book Your Tickets</a>
            <a href="#about" class="btn btn-outline-light btn-lg">Learn More</a>
        </div>
    </div>
</section>
{% endblock %}

{% block content %}

<section class="py-5">
    <div class="container">
        <h2 class="text-center mb-4 section-title">Spectra HoliParty ‚Äì 2nd Year | Your ‚Çπ{{ content.pricing.entry_pass }}
            Pass Includes</h2>
        <p class="text-center mb-5">Get the complete Holi experience with our all-inclusive entry pass. Additional food
            and drinks available at our counters.</p>
        <div class="row">
            <div class="col-md-4 mb-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title">üé® Complimentary Abir</h5>
                        <p class="card-text">Get colorful organic abir included with your entry pass</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title">ü•õ Unlimited Special Lassi</h5>
                        <p class="card-text">Enjoy unlimited servings of our special homemade lassi throughout the event
                        </p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title">üéµ Live Music</h5>
                        <p class="card-text">Dance to the beats of popular Holi songs and remixes</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title">üì∏ Photo Zone</h5>
                        <p class="card-text">Capture colorful memories at our special photo booths</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4">
                <div class="card text-center h-100">
                    <div class="card-body">
                        <h5 class="card-title">üõ°Ô∏è Safe & Secure</h5>
                        <p class="card-text">Family-friendly event with security personnel on site</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-center mt-4">
            <p><strong>Food & Refreshments:</strong> Multiple food counters will be available with a variety of
                delicious options including chaat, fast food, beverages, and traditional Holi treats. Purchases are
                separate from the entry pass.</p>
        </div>
    </div>
</section>

<!-- Previous Year Photos -->
<section id="photos" class="py-5 bg-light">
    <div class="container">
        <h2 class="text-center mb-4 section-title">Previous Year Memories</h2>
        <p class="text-center mb-5">Relive the colorful moments from our past celebrations. Be part of this year's
            unforgettable memories!</p>
        <div class="row g-4 justify-content-center">
            <!-- Video Highlights -->
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 photo-card overflow-hidden shadow-sm border-0 rounded-4">
                    <video class="card-img-top" style="height: 250px; object-fit: cover;" controls preload="metadata"
                        poster="{{ url_for('static', filename='images/image 1.jpeg') }}">
                        <source src="{{ url_for('static', filename='images/h1.mp4') }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    <div class="card-body">
                        <h5 class="card-title mb-0">Holi Vibes</h5>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 photo-card overflow-hidden shadow-sm border-0 rounded-4">
                    <video class="card-img-top" style="height: 250px; object-fit: cover;" controls preload="metadata"
                        poster="{{ url_for('static', filename='images/holi-spectra-group.png') }}">
                        <source src="{{ url_for('static', filename='images/h2.mp4') }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    <div class="card-body">
                        <h5 class="card-title mb-0">Celebration</h5>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 photo-card overflow-hidden shadow-sm border-0 rounded-4">
                    <video class="card-img-top" style="height: 250px; object-fit: cover;" controls preload="metadata"
                        poster="{{ url_for('static', filename='images/holi-women.png') }}">
                        <source src="{{ url_for('static', filename='images/h3.mp4') }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    <div class="card-body">
                        <h5 class="card-title mb-0">Colors of Joy</h5>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 photo-card overflow-hidden shadow-sm border-0 rounded-4">
                    <video class="card-img-top" style="height: 250px; object-fit: cover;" controls preload="metadata"
                        poster="{{ url_for('static', filename='images/holi-canopy.png') }}">
                        <source src="{{ url_for('static', filename='images/h4.mp4') }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    <div class="card-body">
                        <h5 class="card-title mb-0">Festival Fun</h5>
                    </div>
                </div>
            </div>
            <div class="col-md-6 col-lg-4">
                <div class="card h-100 photo-card overflow-hidden shadow-sm border-0 rounded-4">
                    <video class="card-img-top" style="height: 250px; object-fit: cover;" controls preload="metadata"
                        poster="{{ url_for('static', filename='images/image 1.jpeg') }}">
                        <source src="{{ url_for('static', filename='images/h5.mp4') }}" type="video/mp4">
                        Your browser does not support the video tag.
                    </video>
                    <div class="card-body">
                        <h5 class="card-title mb-0">Unforgettable Moments</h5>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="booking" class="py-5">
    <div class="container">
        <h2 class="text-center mb-4"
            style="background: linear-gradient(45deg, #ff2f92, #ffd400, #ffa500, #32cd32, #00ced1, #1e90ff); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; font-weight: bold; font-size: clamp(2.5rem, 5vw, 4rem);">
            Book Your Tickets</h2>

        <div class="group-offer-banner mb-5">
            <div class="group-offer-inner">
                <div class="row align-items-center g-4">
                    <div class="col-12 col-lg-2 text-center order-2 order-lg-1">
                        <span class="group-offer-icon">üéâ</span>
                        <h3 class="group-offer-percent mb-0">15%</h3>
                        <small class="text-white-50">OFF</small>
                    </div>
                    <div class="col-12 col-lg-7 order-1 order-lg-2">
                        <h4 class="mb-2">Special Offers!</h4>
                        <ul class="mb-0 list-unstyled text-white">
                            <li>üî• <strong>Group Booking (8+):</strong> Get <strong>15% OFF</strong>!</li>
                            <li>üë• <strong>Group Booking (5-7):</strong> Get <strong>10% OFF</strong>!</li>
                            <li>‚ù§Ô∏è <strong>Lovebird/Couple (2):</strong> Get <strong>10% OFF</strong>!</li>
                        </ul>
                    </div>
                    <div class="col-12 col-lg-3 text-center text-lg-end order-3">
                        <span class="badge bg-light text-dark fs-6 px-3 py-2">Select passes to apply!</span>
                    </div>
                </div>
            </div>
        </div>

        <div class="row g-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0">Your Details</h4>
                    </div>
                    <div class="card-body">
                        <form id="bookingForm" action="/create_order" method="POST">
                            <input type="hidden" id="pass_type" name="pass_type" value="entry">
                            <input type="hidden" id="amount" name="amount" value="{{ content.pricing.entry_pass }}">
                            <input type="hidden" id="is_couple_booking" name="is_couple_booking" value="false">
                            <div class="mb-4">
                                <label for="name" class="form-label">Full Name *</label>
                                <input type="text" class="form-control" id="name" name="name"
                                    placeholder="Enter your full name" required>
                            </div>
                            <div class="mb-4">
                                <label for="email" class="form-label">Email Address *</label>
                                <input type="email" class="form-control" id="email" name="email"
                                    placeholder="your@email.com" required>
                            </div>
                            <div class="mb-4">
                                <label for="phone" class="form-label">Phone Number *</label>
                                <input type="tel" class="form-control" id="phone" name="phone"
                                    placeholder="10-digit mobile number" pattern="[0-9]{10}" maxlength="10" required>
                                <div class="form-text">Enter 10-digit mobile number (e.g., 9876543210)</div>
                            </div>
                            <div class="mb-4">
                                <label for="address" class="form-label">Full Address *</label>
                                <textarea class="form-control" id="address" name="address" rows="3"
                                    placeholder="Enter your complete address (street, city, state, pincode)"
                                    required></textarea>
                                <div class="form-text">This address will be used for ticket delivery and event
                                    communication</div>
                            </div>
                            <div class="mb-4">
                                <label class="form-label">Pass Type *</label>
                                <div class="row g-2">
                                    <div class="col-12">
                                        <div class="form-check border rounded p-3 pass-option" data-type="entry">
                                            <input class="form-check-input" type="radio" name="pass_type_radio"
                                                id="passEntry" value="entry"
                                                data-price="{{ content.pricing.entry_pass }}" checked>
                                            <label class="form-check-label w-100" for="passEntry">
                                                <strong>Entry Only</strong> ‚Äì ‚Çπ{{ content.pricing.entry_pass
                                                }}/person<br>
                                                <small class="text-muted">Complimentary Abir, Lassi, Live Music, Photo
                                                    Booth</small>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-check border rounded p-3 pass-option"
                                            data-type="entry_starter">
                                            <input class="form-check-input" type="radio" name="pass_type_radio"
                                                id="passStarter" value="entry_starter"
                                                data-price="{{ content.pricing.entry_plus_starter }}">
                                            <label class="form-check-label w-100" for="passStarter">
                                                <strong>Entry + Starter</strong> ‚Äì ‚Çπ{{
                                                content.pricing.entry_plus_starter }}/person<br>
                                                <small class="text-muted">All entry benefits + Welcome snacks &
                                                    beverages</small>
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-check border rounded p-3 pass-option"
                                            data-type="entry_starter_lunch">
                                            <input class="form-check-input" type="radio" name="pass_type_radio"
                                                id="passLunch" value="entry_starter_lunch"
                                                data-price="{{ content.pricing.get('entry_plus_starter_lunch', 499) }}">
                                            <label class="form-check-label w-100" for="passLunch">
                                                <strong>Entry + Starter + Lunch</strong> ‚Äì ‚Çπ{{
                                                content.pricing.get('entry_plus_starter_lunch', 499) }}/person<br>
                                                <small class="text-muted">All benefits + Full lunch included</small>
                                            </label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-4">
                                <label for="passes" class="form-label">Number of Passes *</label>
                                <select class="form-select" id="passes" name="passes" required>
                                    <option value="1">1 Pass</option>
                                    <option value="2">2 Passes</option>
                                    <option value="3">3 Passes</option>
                                    <option value="4">4 Passes</option>
                                    <option value="5">5 Passes</option>
                                    <option value="6">6 Passes</option>
                                    <option value="7">7 Passes</option>
                                    <option value="8">8 Passes</option>
                                    <option value="9">9 Passes</option>
                                    <option value="10">10 Passes</option>
                                    <option value="11">11 Passes</option>
                                    <option value="12">12 Passes</option>
                                    <option value="13">13 Passes</option>
                                    <option value="14">14 Passes</option>
                                    <option value="15">15 Passes</option>
                                    <option value="16">16 Passes</option>
                                    <option value="17">17 Passes</option>
                                    <option value="18">18 Passes</option>
                                    <option value="19">19 Passes</option>
                                    <option value="20">20 Passes</option>
                                </select>

                                <div class="form-check mt-3" id="coupleDiscountContainer" style="display: none;">
                                    <input class="form-check-input" type="checkbox" id="coupleDiscountCheck">
                                    <label class="form-check-label fw-bold text-danger" for="coupleDiscountCheck">
                                        ‚ù§Ô∏è Apply Couple/Lovebird Discount (10% Off)
                                    </label>
                                </div>

                                <div class="form-text mt-2" id="groupDiscountText" style="display: none;"></div>
                            </div>
                            <button type="submit" class="btn btn-success btn-lg w-100" id="submitBtn"
                                style="background: linear-gradient(45deg, #ff2f92, #ffd400); border: none;">
                                Proceed to Payment - ‚Çπ<span id="buttonTotal">{{ content.pricing.entry_pass }}</span>
                            </button>
                        </form>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header">
                        <h4 class="mb-0">Booking Summary</h4>
                    </div>
                    <div class="card-body">
                        <div class="alert alert-info">
                            <h5>üé´ Pass Options</h5>
                            <p class="mb-1 small">Entry: ‚Çπ{{ content.pricing.entry_pass }} | Entry+Starter: ‚Çπ{{
                                content.pricing.entry_plus_starter }} | Entry+Starter+Lunch: ‚Çπ{{
                                content.pricing.get('entry_plus_starter_lunch', 499) }}</p>
                            <p class="mb-0">Selected: <strong><span id="selectedPasses">1</span> pass(es)</strong> ‚Äì
                                <span id="passTypeLabel">Entry Only</span>
                            </p>
                            <p class="mb-0 mt-1">Subtotal: ‚Çπ<span id="subtotal">{{ content.pricing.entry_pass }}</span>
                                <span id="discountLine"
                                    style="display: none; color: #28a745; font-weight: bold;"></span>
                            </p>
                            <p class="mb-0"><strong style="color: #ff2f92; font-size: 1.2em;">Total: ‚Çπ<span
                                        id="total">{{ content.pricing.entry_pass }}</span></strong></p>
                        </div>
                        <h6>üéâ What's Included:</h6>
                        <ul class="list-unstyled">
                            <li>‚úÖ Complimentary Organic Abir</li>
                            <li>‚úÖ Welcome Snacks & Beverages</li>
                            <li>‚úÖ Live Music & Bollywood</li>
                            <li>‚úÖ Professional Photo Booth</li>
                            <li>‚úÖ Traditional Holi Activities</li>
                            <li>‚úÖ Security & First Aid</li>
                        </ul>
                        <div class="alert alert-warning">
                            <small><strong>üìÖ Event Date:</strong> {{ content.event_date }}<br>
                                <strong>üïê Time:</strong> {{ content.event_time }}<br>
                                <strong>üìç Venue:</strong> {{ content.venue }}<br>
                                <strong>üçî Food:</strong> {{ content.pricing.food_available }}</small>
                        </div>
                        <p class="small text-muted">By proceeding, you agree to our terms. Instant ticket delivery via
                            email. No refunds after payment confirmation.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<section id="about" class="py-5 bg-light">
    <div class="container">
        <h2 class="text-center mb-4 section-title">About Spectra HoliParty</h2>
        <p class="text-center">Our <strong>2nd year</strong> of organizing HoliParty! Join us for the most colorful
            celebration. Experience joy, music, and the spirit of Holi!</p>
        <div class="row">
            <div class="col-md-6">
                <h4>Premium Experience</h4>
                <p>Experience the ultimate Holi celebration with premium facilities and unlimited fun. Event schedule:
                    <strong>10:00 AM ‚Äì 5:00 PM</strong>. Book your spot now!
                </p>
            </div>
            <div class="col-md-6">
                <h4>2026 Edition</h4>
                <p>Our 2nd year of bringing the festival of colors to the community at Kunjachaya, Bhadreswar.</p>
            </div>
        </div>
    </div>
</section>
<script>
    const PASS_LABELS = { entry: 'Entry Only', entry_starter: 'Entry + Starter', entry_starter_lunch: 'Entry + Starter + Lunch' };

    function updateBookingTotal() {
        const passes = parseInt(document.getElementById('passes').value) || 1;
        const selectedRadio = document.querySelector('input[name="pass_type_radio"]:checked');

        if (!selectedRadio) return;

        const passType = selectedRadio.value;
        const pricePerPerson = parseInt(selectedRadio.getAttribute('data-price')) || 200;

        let subtotal = passes * pricePerPerson;
        let discount = 0;
        let discountText = '';
        let isGroup = false;
        let isCouple = false;

        // Handle Couple Discount Checkbox Visibility
        const coupleContainer = document.getElementById('coupleDiscountContainer');
        const coupleCheck = document.getElementById('coupleDiscountCheck');

        if (passes === 2) {
            coupleContainer.style.display = 'block';
            if (coupleCheck.checked) {
                isCouple = true;
            }
        } else {
            coupleContainer.style.display = 'none';
            coupleCheck.checked = false; // Reset if not 2 passes
        }

        // Calculate Discount
        if (passes >= 8) {
            discount = Math.round(subtotal * 0.15);
            discountText = '‚Äì 15% Group Discount (8+ Tix)';
            document.getElementById('groupDiscountText').innerHTML = 'üéâ <strong>Mega Group Offer!</strong> 15% discount applied for 8+ members';
            document.getElementById('groupDiscountText').style.display = 'block';
            isGroup = true;
        } else if (passes >= 5) {
            discount = Math.round(subtotal * 0.10);
            discountText = '‚Äì 10% Group Discount (5+ Tix)';
            document.getElementById('groupDiscountText').innerHTML = 'üéâ <strong>Group Offer!</strong> 10% discount applied for 5+ members';
            document.getElementById('groupDiscountText').style.display = 'block';
            isGroup = true;
        } else if (isCouple) {
            discount = Math.round(subtotal * 0.10);
            discountText = '‚Äì 10% Couple Discount ‚ù§Ô∏è';
            document.getElementById('groupDiscountText').style.display = 'none';
        } else {
            document.getElementById('groupDiscountText').style.display = 'none';
        }

        const total = subtotal - discount;

        document.getElementById('pass_type').value = passType;
        document.getElementById('amount').value = total;
        document.getElementById('is_couple_booking').value = isCouple ? 'true' : 'false';

        document.getElementById('subtotal').textContent = subtotal;
        document.getElementById('total').textContent = total;
        document.getElementById('buttonTotal').textContent = total;
        document.getElementById('selectedPasses').textContent = passes;
        document.getElementById('passTypeLabel').textContent = PASS_LABELS[passType] || 'Entry Only';

        const discountLine = document.getElementById('discountLine');
        if (discount > 0) {
            discountLine.textContent = discountText;
            discountLine.style.display = 'inline';
        } else {
            discountLine.style.display = 'none';
        }

        // Highlight selected option
        document.querySelectorAll('.pass-option').forEach(opt => {
            opt.classList.remove('border-primary', 'bg-light');
            if (opt.querySelector('input').checked) {
                opt.classList.add('border-primary', 'bg-light');
            }
        });
    }

    document.addEventListener('DOMContentLoaded', function () {
        // Attach change listeners
        document.querySelectorAll('input[name="pass_type_radio"]').forEach(r => {
            r.addEventListener('change', updateBookingTotal);
        });

        document.getElementById('passes').addEventListener('change', updateBookingTotal);
        document.getElementById('coupleDiscountCheck').addEventListener('change', updateBookingTotal);

        // Initial calculation
        updateBookingTotal();

        // Make whole card clickable
        document.querySelectorAll('.pass-option').forEach(opt => {
            opt.addEventListener('click', function (e) {
                if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'LABEL') {
                    const radio = this.querySelector('input[type="radio"]');
                    if (radio) {
                        radio.checked = true;
                        radio.dispatchEvent(new Event('change'));
                    }
                }
            });
        });
    });

    // Form validation
    document.getElementById('bookingForm').addEventListener('submit', function (e) {
        const phone = document.getElementById('phone').value;
        const email = document.getElementById('email').value;
        const name = document.getElementById('name').value;
        const address = document.getElementById('address').value;

        // Validate name
        if (name.trim().length < 2) {
            alert('Please enter your full name');
            e.preventDefault();
            return false;
        }

        // Validate email
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
            alert('Please enter a valid email address');
            e.preventDefault();
            return false;
        }

        // Validate phone
        if (phone.length !== 10 || !/^\d{10}$/.test(phone)) {
            alert('Please enter a valid 10-digit phone number');
            e.preventDefault();
            return false;
        }

        // Validate address
        if (address.trim().length < 10) {
            alert('Please enter your complete address (minimum 10 characters)');
            e.preventDefault();
            return false;
        }

        // Show loading state
        const submitBtn = document.getElementById('submitBtn');
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2" role="status"></span>Processing your booking...';

        // Form will submit normally
    });
</script>
{% endblock %}